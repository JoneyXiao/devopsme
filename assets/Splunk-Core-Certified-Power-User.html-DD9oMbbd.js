import{_ as h}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as k,a,b as t,d as s,e as n,w as l,r,o as d}from"./app-DjJ1ZpY8.js";const p="/devopsme/assets/dashboard_input_token_interaction-Bjoc_hFC.png",o="/devopsme/assets/workflow_actions_demo-BVoxnaOs.png",c={};function g(B,i){const e=r("RouteLink");return d(),k("div",null,[i[6]||(i[6]=a(`<p>Exam preparation notes for the <span style="color:#12db8e;"><strong>Splunk Core Certified Power User</strong></span>.</p><h2 id="transforming-commands" tabindex="-1"><a class="header-anchor" href="#transforming-commands"><span>Transforming Commands</span></a></h2><p>If you are doing search in smart mode, the mode that will toggle the search behavior based on if the search contains a transforming command. If it does, then it&#39;s going to act like fast mode,</p><ul><li><p>top: <code>index=web | top file</code>, <code>index=security &quot;fail*&quot; | top src showperc=f</code></p></li><li><p>rare: <code>index=web |rare categoryId</code></p></li><li><p>stats:</p><div class="language-spl line-numbers-mode" data-highlighter="shiki" data-ext="spl" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">index</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=web |</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> stats</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> sum</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">bytes</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">index</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=web |</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> stats</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> count</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> by</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> categoryId</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">index</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=web |</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> stats</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> dc(</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">categoryId</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"># </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">or</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">index</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=web </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">categoryId</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=* |</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> dedup</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> categoryId</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"># </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">or</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">index</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=web </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">categoryId</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=* |</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> dedup</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> categoryId |</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> stats</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> list</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">categoryId</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"># </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">or</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">index</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=web |</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> stats</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> values</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">categoryId</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">index</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=web |</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> stats</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> count</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> by</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> referer_domain, action</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">index</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=web |</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> stats</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> count</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> by</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> referer_domain, action |</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> stats</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> sum</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">count</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">by</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> referer_domain</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">index</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=security |</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> stats</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> count</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> by</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> src,</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;"> user</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, action</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">index</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=security |</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> stats</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> values</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">user</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">as</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;Login Name&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">count</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">user</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">as</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;Attempts&quot;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> by</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> src |</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> fillnull</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> value</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;N/A&quot;</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">index</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=web </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">OR</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> index</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=security |</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> stats</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> sum</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">bytes</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">as</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> Total_Bytes |</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> eval</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> Total_Bytes</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">tostring</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">Total_Bytes</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;commas&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><p>More useful commands:</p><div class="language-spl line-numbers-mode" data-highlighter="shiki" data-ext="spl" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">index</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=web |</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> table</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> clientip,</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;"> action</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;"> categoryId</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, status |</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> where</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> isnotnull</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">action</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">index</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=web |</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> table</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> clientip,</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;"> action</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;"> categoryId</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, status |</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> where</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> isnotnull</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">action</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) |</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> rename</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> action </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">as</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;ACTION&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, clientip </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">as</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;Shoppers IP&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> |</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> fields</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> - status</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">index</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=security </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">user</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=admin </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">vendor_action</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=Failed </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">host</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=web1 </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">src_ip</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;87.194.216.51&quot;</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> earliest</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> latest</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=now</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="transaction-commands" tabindex="-1"><a class="header-anchor" href="#transaction-commands"><span>Transaction Commands</span></a></h2><ul><li><p><code>maxspan</code>: Max time between all related events, e.g. <code>maxspan=15m</code>.</p></li><li><p><code>maxpause</code>: Max time between each individual event, e.g. <code>maxpause=1m</code>.</p></li><li><p><code>startswith</code> &amp; <code>endswith</code>: Set your variables for keywords.</p></li></ul><h3 id="investigate-the-events" tabindex="-1"><a class="header-anchor" href="#investigate-the-events"><span>Investigate the events</span></a></h3><ul><li>Events that span time: Can come from multiple hosts, relate to one host of interest.</li><li>Grouping of events: Show the entire conversation, from start to finish in one view.</li><li>Aid investigations: Relate user activity for logins, session lengths, browsing history, etc.</li><li>Log validation: Check to see if data is related to network logs of interest, website traffic, emails, etc.</li></ul><h3 id="transaction-vs-stats" tabindex="-1"><a class="header-anchor" href="#transaction-vs-stats"><span>Transaction vs. stats</span></a></h3><table><thead><tr><th>Transaction</th><th>Stats</th></tr></thead><tbody><tr><td>Slow abd will tax your environment</td><td>Faster, more efficient searching</td></tr><tr><td>Granular analysis(logs, user behavior, conversations, etc,)</td><td>Looking at larger pool of events for trend analysis(no limit on number of events returned)</td></tr><tr><td>Small scope on one item of interest</td><td>Broad searching and grouping of events</td></tr><tr><td>Correlations need to be found from start to end</td><td>Mathematical functions needed</td></tr></tbody></table><h3 id="demo" tabindex="-1"><a class="header-anchor" href="#demo"><span>Demo</span></a></h3><div class="language-spl line-numbers-mode" data-highlighter="shiki" data-ext="spl" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">index</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=web </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">|</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> search</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> status</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">404</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">|</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> transaction</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> JSESSIONID </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">maxspan</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=10m </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">maxpause</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=3s</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-spl line-numbers-mode" data-highlighter="shiki" data-ext="spl" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">index</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=security failed</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">|</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> transaction</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> src </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">maxspan</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=3m </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">maxpause</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=3s </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">|</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> eval</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> duration</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">tostring</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">duration</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;duration&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) # evaluate a new field</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">|</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> table</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> src, duration</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-spl line-numbers-mode" data-highlighter="shiki" data-ext="spl" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">index</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=web</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">|</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> transaction</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> clientip </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">maxspan</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=10m </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">maxpause</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=3s </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">endswith</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=purchase</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">|</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> eval</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> duration</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">tostring</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">duration</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;duration&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">|</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> table</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> clientip,</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;"> duration</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, action</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="manipulating-your-data" tabindex="-1"><a class="header-anchor" href="#manipulating-your-data"><span>Manipulating Your Data</span></a></h2><h3 id="eval" tabindex="-1"><a class="header-anchor" href="#eval"><span>eval</span></a></h3><ul><li>Calculates fields: Does the math you ask: +, -, *, /, AND, XOR, &gt;=, ==</li><li>Functions friendly: Just like stats, it takes plenty of functional arguments: <code>if, null, true, cidrmatch, like, lookup, tostring, md5, now, strftime</code></li><li>Create new fields: Eval will take the results of the SPL into a field that is existing, or create a new one</li><li>Coverting data: Tell Splunk to display a field value of bytes to megabytes by providing the math in an eval statement: <code>strftime, strptime</code>.</li></ul><h3 id="where-search" tabindex="-1"><a class="header-anchor" href="#where-search"><span>where &amp; search</span></a></h3><table><thead><tr><th>where</th><th>search</th></tr></thead><tbody><tr><td>Can not place before first</td><td>in the SPL</td></tr><tr><td>Comparing values, or searching for a matching value</td><td>Search on a keyword, or matching value</td></tr><tr><td>Use with functions</td><td>Search with wildcards</td></tr><tr><td>*think boolean operators=where</td><td>*think expressional searches=search</td></tr></tbody></table><h3 id="demo-1" tabindex="-1"><a class="header-anchor" href="#demo-1"><span>Demo</span></a></h3><div class="language-spl line-numbers-mode" data-highlighter="shiki" data-ext="spl" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">index</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=_internal </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">|</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> eval</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> epoch_time</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">strptime</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">_time</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;%s&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">|</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> eval</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> human_readable_time</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">strftime</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">epoch_time</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;%m/%d/%y&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">|</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> table</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> _time,</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;"> epoch_time</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, human_readable_time</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-spl line-numbers-mode" data-highlighter="shiki" data-ext="spl" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">index</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=_internal </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">|</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> eval</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> DayOfTheYear</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">strftime</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">_time</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;%j&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">|</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> search</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> DayOfTheYear</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">141</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-spl line-numbers-mode" data-highlighter="shiki" data-ext="spl" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">index</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=web</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">|</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> eval</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> status_codes</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">case</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">status</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">==</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">404</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">), </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;Not Found&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">status</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">==</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">400</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">), </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;Bad Request Response&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, (</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">status</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">==</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">200</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">), </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;Success&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">|</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> stats</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> count</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> by</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> status, status_codes</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-spl line-numbers-mode" data-highlighter="shiki" data-ext="spl" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">index</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=web</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">|</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> stats</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> count</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">eval</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">status</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">==</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">404</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)) </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">as</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;Number of not founds&quot;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-spl line-numbers-mode" data-highlighter="shiki" data-ext="spl" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">index</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=web</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">|</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> eval</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> hash</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">md5</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">file</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">|</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> table</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> file, hash</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">|</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> dedup</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> file</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-spl line-numbers-mode" data-highlighter="shiki" data-ext="spl" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">index</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=security</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">|</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> table</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> src,</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;"> user</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, action</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">|</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> where</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> like</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">src</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;50.%&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">AND</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> user</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;mail&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> # boolean logic</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-spl line-numbers-mode" data-highlighter="shiki" data-ext="spl" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">index</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=security</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">|</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> table</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> src,</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;"> user</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, action</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">|</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> where</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> like</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">src</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;50.%&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">|</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> search</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> user</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=mail</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="field-extractions" tabindex="-1"><a class="header-anchor" href="#field-extractions"><span>Field Extractions</span></a></h2><ul><li>Regex: Unstructured data</li><li>Delimiters: Structured data</li><li>Commands: Work with <code>rex</code> and <code>erex</code> in your SPL.</li></ul><p><code>rex</code> uses a regex to create a new field out of a filed that already exists.</p><p><code>erex</code> helps to generate the regex as long as you provide example of what you want to extract.</p><p>3 ways to navigate to Field Extractor:</p><ul><li>Settings &gt; Fields &gt; Fields Extractions &gt; Open Field Extractor</li><li>From the &quot;Event Actions&quot; dropdown menu</li><li>The bottom of the left panel, under the &quot;INTERESTING FIELDS&quot;</li></ul><h3 id="demo-2" tabindex="-1"><a class="header-anchor" href="#demo-2"><span>Demo</span></a></h3><p><a href="https://regex101.com" target="_blank" rel="noopener noreferrer">Regular Expressions 101</a></p><div class="language-spl line-numbers-mode" data-highlighter="shiki" data-ext="spl" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">index</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=cisco </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">|</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> rex</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> field</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=_raw (?&lt;email&gt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;\\S+@\\S+\\.com&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-spl line-numbers-mode" data-highlighter="shiki" data-ext="spl" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">index</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=cisco </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">|</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> erex</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> files </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">examples</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;text/css&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;image/gif&quot;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">|</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> stats</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> values</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">files</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">), </span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">values</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">http_content_type</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="lookups" tabindex="-1"><a class="header-anchor" href="#lookups"><span>Lookups</span></a></h2><p>What&#39;s a lookup?</p><ul><li>A file. Mostly static data that is not in an index. e.g. csv of all employees.</li><li>A tool. Add additional fields to search for. Fields will be added to the fields bar menu.</li></ul><p>How to use?</p><ul><li>Data enrichment. Add information and store it in a table/file format to then search.</li><li>Commands: lookup, inputlookup, outputlookup, OUTPUT, OUTPUTNEW.</li><li>Create or Upload. Select a file to upload or make one to reference. Lookups can be configured to run automatically.</li></ul><h3 id="demo1" tabindex="-1"><a class="header-anchor" href="#demo1"><span>Demo1</span></a></h3><ol><li><p>Create a &quot;Lookup table files&quot;</p><div class="language-spl line-numbers-mode" data-highlighter="shiki" data-ext="spl" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">|</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> inputlookup</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> peopleinfo.csv </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">where</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">state</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;New York&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li><li><p>Create a &quot;Lookup definitions&quot; using the created lookup table <code>peopleinfo.csv</code>(file-based).</p></li><li><p>Update permissions.</p></li></ol><h3 id="demo2" tabindex="-1"><a class="header-anchor" href="#demo2"><span>Demo2</span></a></h3><ol><li><p>Export the product ids as csv.</p><div class="language-spl line-numbers-mode" data-highlighter="shiki" data-ext="spl" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">index</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=web |</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> table</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> productId |</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> dedup</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> productId</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>Then and additional information in the exported csv.</p></li><li><p>Create a &quot;Lookup table files&quot; using the updated csv.</p></li><li><p>Update permissions.</p></li><li><p>Search</p><div class="language-spl line-numbers-mode" data-highlighter="shiki" data-ext="spl" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">index</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=web </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">action</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=purchase</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">|</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> lookup</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> productinfo.csv productId </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">OUTPUT</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> description</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">|</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> table</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> productId descrition</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">|</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> where</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> isnotnull</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">productId</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-spl line-numbers-mode" data-highlighter="shiki" data-ext="spl" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">index</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=web </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">action</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=purchase</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">|</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> lookup</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> productinfo.csv productId </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">OUTPUT</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> description</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">|</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> stats</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> count</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> by</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> productId description</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">|</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> where</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> isnotnull</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">productId</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">|</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> sort</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> - </span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">count</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ol><h2 id="visualization" tabindex="-1"><a class="header-anchor" href="#visualization"><span>Visualization</span></a></h2><h3 id="commands" tabindex="-1"><a class="header-anchor" href="#commands"><span>Commands</span></a></h3><ul><li>timechart: time series will display statistical trends over time, single or multi-series, <code>span=1d</code></li><li>chart: line, area, bar, bubble, pie, scatter, etc, stacking available, remove empty values <code>useother=f usenull=f</code></li><li>stats: can easily alter any stats table</li><li>iplocation: add location info to your visualizations</li><li>geostats: calculate functions to display on a cluster map. <code>latfield, longfield, globallimit, locallimit</code></li><li>addtotals: add multiple values together on a chart, compute total sums of values. <code>fieldname, label, labelfield</code></li><li>trendline: overlay on a chart to show the moving average. <code>sma, ema, wma</code></li></ul><h3 id="options-to-set-in-visualization" tabindex="-1"><a class="header-anchor" href="#options-to-set-in-visualization"><span>Options to set in visualization</span></a></h3><ul><li>stacking: On=events are vertically stacked(top to bottom), Off=counts are horizontally stacked(left to right)</li><li>overlay: add two line charts over each other</li><li>trellis: display multiple charts at once</li><li>multi-series: On=y-axis to split for each value, Off=all fields share the y-axis</li></ul><h3 id="demo-3" tabindex="-1"><a class="header-anchor" href="#demo-3"><span>Demo</span></a></h3><p>Timechart:</p><div class="language-spl line-numbers-mode" data-highlighter="shiki" data-ext="spl" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">index</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=web |</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> timechart</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> avg</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">bytes</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">by</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> host</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>Chart: doesn&#39;t give you data over time.</p><div class="language-spl line-numbers-mode" data-highlighter="shiki" data-ext="spl" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">index</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=web |</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> chart</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> avg</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">bytes</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">by</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> host</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>Timechart with where:</p><div class="language-spl line-numbers-mode" data-highlighter="shiki" data-ext="spl" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">index</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=web |</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> where</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> isnotnull</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">action</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) |</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> timechart</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> count</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> by</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> action</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p><code>useother=f</code> means takes the OTHER value off the chart. It displays the top 10 values by default, <code>limit=0</code> means no limitation to return all values.</p><div class="language-spl line-numbers-mode" data-highlighter="shiki" data-ext="spl" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">index</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=web </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">action</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=purchase</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">|</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> lookup</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> productinfo.csv productId </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">OUTPUT</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> description</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">|</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> where</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> isnotnull</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">productId</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">|</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> chart</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> count</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> over</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> host </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">by</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> description </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">useother</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=f </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">limit</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Line chart</p><div class="language-spl line-numbers-mode" data-highlighter="shiki" data-ext="spl" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">index</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=security Failed</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">|</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> timechart</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> count</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> by</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> user </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">useother</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=f </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">usenull</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=f </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">limit</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">5</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>Area chart. <code>Add 5-period simple moving average trendline for smoothing</code></p><div class="language-spl line-numbers-mode" data-highlighter="shiki" data-ext="spl" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">index</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=_internal </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">sourcetype</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=splunkd</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">|</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> timechart</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> count</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">|</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> trendline</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> sma5(</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">count</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">as</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;Moving Average of Total Events&quot;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>It creates a new column &quot;City&quot; which based on the latitude and longitude information associated with the <code>ip_address</code>.</p><div class="language-spl line-numbers-mode" data-highlighter="shiki" data-ext="spl" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">|</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> inputlookup</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> peopleinfo.csv</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">|</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> iplocation</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> ip_address</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p><code>iplocation</code> command can generate the latitude and longitude fields if they don&#39;t exists.</p><div class="language-spl line-numbers-mode" data-highlighter="shiki" data-ext="spl" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">index</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=web |</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> iplocation</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> clientip</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>Cluster map</p><div class="language-spl line-numbers-mode" data-highlighter="shiki" data-ext="spl" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">|</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> inputlookup</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> peopleinfo.csv</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">|</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> geostats</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> latfield</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=lat </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">longfield</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=long </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">globallimit</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">10</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> count</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> by</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> email</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-spl line-numbers-mode" data-highlighter="shiki" data-ext="spl" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">index</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=web </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">action</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=purchase</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">|</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> iplocation</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> clientip</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">|</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> geostats</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> count</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> by</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> action</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">|</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> where</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> purchase&gt;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">500</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>addtotals</code> or change the options in the statistics format(Format -&gt; Summary -&gt; Totals/Percentages).</p><div class="language-spl line-numbers-mode" data-highlighter="shiki" data-ext="spl" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">index</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=web </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">action</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=purchase</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">|</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> iplocation</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> clientip</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">|</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> geostats</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> count</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> by</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> action</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">|</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> addtotals</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> row</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=f </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">col</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=t </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">label</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;Total Purchases&quot;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> labelfield</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=longitude purchase</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="reports-drilldowns" tabindex="-1"><a class="header-anchor" href="#reports-drilldowns"><span>Reports &amp; Drilldowns</span></a></h2><h3 id="what-are-reports" tabindex="-1"><a class="header-anchor" href="#what-are-reports"><span>What are reports?</span></a></h3><ul><li>A saved search: anything that is a search can be saved as a report.</li><li>Live results: re-run a report, or set it to run on a schedule.</li><li>Sharable Knowledge Object: let anyone view your reports, or add them to a dashboard for people to reference.</li><li>Splunk knowledge object naming convention best practice: <code>{group_name}_{object}_{description}</code></li></ul><h3 id="drilldown-functionality-interactions" tabindex="-1"><a class="header-anchor" href="#drilldown-functionality-interactions"><span>Drilldown Functionality(Interactions)</span></a></h3><ul><li>Actions: link to search, link to dashboard, link to report</li><li>$token$: tokens play a key role in passing variables from panel to panel</li><li>Export: export as a PDF, print, or include in a report</li></ul><h3 id="home-dashboard" tabindex="-1"><a class="header-anchor" href="#home-dashboard"><span>Home Dashboard</span></a></h3><p>Navigate to Settings &gt; Dashboards &gt; Edit &gt; Set as Home Dashboard</p><h3 id="demo-4" tabindex="-1"><a class="header-anchor" href="#demo-4"><span>Demo</span></a></h3><div class="language-spl line-numbers-mode" data-highlighter="shiki" data-ext="spl" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">index</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=_internal </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">log_level</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=*</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">|</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> eval</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> Date</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">strftime</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">_time</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;%m/%d/%Y&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">|</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> where</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> isnotnull</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">reason</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">|</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> table</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> log_level,</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;"> reason</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, Date</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">|</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> dedup</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> reason</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">|</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> sort</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> Date</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Save as a dashboard panel and <em>add input(Text)</em> in it, then update the spl(panel data source) using <em>token name - log_level</em> :</p><div class="language-spl line-numbers-mode" data-highlighter="shiki" data-ext="spl" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">index</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=_internal </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">log_level</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=$log_level$</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">|</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> eval</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> Date</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">strftime</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">_time</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;%m/%d/%Y&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">|</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> where</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> isnotnull</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">reason</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">|</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> table</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> log_level,</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;"> reason</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, Date</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">|</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> dedup</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> reason</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">|</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> sort</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> Date</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>We can also add an input &quot;Time range&quot;, then update the &quot;Time range&quot; of the data source as <code>Time Range(time)</code>.</p><figure><img src="`+p+`" alt="Dashboard Input Token Interactions" tabindex="0" loading="lazy"><figcaption>Dashboard Input Token Interactions</figcaption></figure><p>Save below search as report(schedule report) and put it into the dashboard:</p><div class="language-spl line-numbers-mode" data-highlighter="shiki" data-ext="spl" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">index</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=web </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">action</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=purchase </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">categoryId</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=TEE </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">|</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> table</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> action,</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;"> uri</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, status</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>Then we can add a <em>interaction</em> &quot;Link to search&quot; for this report. Now the field values are clickable and hyperlinked.</p><p>Or we can <em>Add interactions</em> &quot;Set tokens&quot;(Use predefined token, token name: userclick_field, token value: name, token name: userclick_value, token value: value), then add a new event(chart/panel) and set its data source <code>index=* $userclick_field$=$userclick_value$</code>.</p><h2 id="alerts" tabindex="-1"><a class="header-anchor" href="#alerts"><span>Alerts</span></a></h2><h3 id="what-are-alerts" tabindex="-1"><a class="header-anchor" href="#what-are-alerts"><span>What are Alerts?</span></a></h3><ul><li>Saved searches: run on schedule, run real-time</li><li>Content matches: fire when a condition is matched</li><li>Create trigger actions: log, send mail, webhook, custom action</li><li>Create trigger conditions: per-result, # of results, # of sources, custom, throttle</li></ul><h2 id="tags-and-events" tabindex="-1"><a class="header-anchor" href="#tags-and-events"><span>Tags and events</span></a></h2>`,96)),t("p",null,[i[1]||(i[1]=s("More information about tags and events can be found ")),n(e,{to:"/categories/splunk/Splunk-Advanced-Concepts.html#tags"},{default:l(()=>i[0]||(i[0]=[s("here")])),_:1,__:[0]}),i[2]||(i[2]=s("."))]),i[7]||(i[7]=a(`<h3 id="what-s-a-tag" tabindex="-1"><a class="header-anchor" href="#what-s-a-tag"><span>What&#39;s a tag?</span></a></h3><ul><li>Quick reminder: what was I trying to see again</li><li>Aid for reading data: create as many tags as you want</li><li>Case sensitive: typing matters when searching</li></ul><h3 id="what-are-event-types" tabindex="-1"><a class="header-anchor" href="#what-are-event-types"><span>What are event types?</span></a></h3><ul><li>Highlighter: make them colors, mark events with similar criteria</li><li>Like a report, but not: save searches as specific event types, sort into categories, no time range. For example, <code>status=404</code> can be saved as &quot;Not Found&quot;</li><li>More specific: set strings, field values, and tags</li></ul><h3 id="demo-5" tabindex="-1"><a class="header-anchor" href="#demo-5"><span>Demo</span></a></h3><ol><li>Create a tag for a selected field in an event.</li><li>Search it <code>index=web tag=login</code></li></ol><h2 id="macros" tabindex="-1"><a class="header-anchor" href="#macros"><span>Macros</span></a></h2><p>Navigate to Settings -&gt; Advanced search -&gt; Search macros</p><ul><li>Shortcuts: fast, saved off searches to run by name</li><li>Repeatable: the macro never changes, unless you edit it</li><li>Expandable: ctrl+shift+e for windows, command+shift+e for macos</li><li><code>macroname</code>: run with the use of backticks, not single quotes</li></ul><h3 id="demo-1-1" tabindex="-1"><a class="header-anchor" href="#demo-1-1"><span>Demo 1</span></a></h3><p>Create a new search macro with a &quot;Name&quot; and &quot;Definition&quot;, use below spl as macro definition.</p><div class="language-spl line-numbers-mode" data-highlighter="shiki" data-ext="spl" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">index</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=web </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">action</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=purchase</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">|</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> stats</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> count</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> by</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> host</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">|</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> addtotals</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> col</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=t </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">row</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=f </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">fieldname</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;Total&quot;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> labelfield</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=host </span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">count</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Then type <code>macroexample</code> in the search bar. This will run the macro which is equivalent to the spl above.</p><h3 id="demo-2-1" tabindex="-1"><a class="header-anchor" href="#demo-2-1"><span>Demo 2</span></a></h3><p>Create a new search macro <code>loglevel(1)</code> with below spl and a argument <code>input</code>.</p><blockquote><p>If use arguments, you have to specify in the macro name how many arguments used.</p></blockquote><div class="language-spl line-numbers-mode" data-highlighter="shiki" data-ext="spl" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">index</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=_internal </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">log_level</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=$input$</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">|</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> table</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> host,</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;"> log_level event_message</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, _time</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>To run a macro with an argument, you need to specify what you&#39;re putting in. For example, <code>loglevel(ERROR)</code> or <code>loglevel(*)</code>.</p><h2 id="workflows" tabindex="-1"><a class="header-anchor" href="#workflows"><span>Workflows</span></a></h2><p>Navigate to Settings -&gt; Fields -&gt; Workflow Actions</p><ul><li>Assess Actions: Depending on use case, there are three available workflow actions which provide different functionalities</li><li>Create Workflow Action: Using Splunk Web, create a new Workflow Action to either push, pull or search data</li><li>Configure Workflow Action: Within the Web GUI, configure the previously determined action type with a 3rd party source</li><li>Validation: Check to see if data is being pushed, pulled or searched for after configuration</li></ul><h3 id="workflow-actions" tabindex="-1"><a class="header-anchor" href="#workflow-actions"><span>Workflow Actions</span></a></h3><ul><li>GET: Create HTML links to interact with sites. Ex: Google searches, querying WHOIS databases</li><li>POST: Generate HTTP POST request to specified URI. Ex: Create entries in management systems, forums</li><li>Search: Launch secondary searches using field values. Ex: Occurrences of IP addresses over events</li></ul><h3 id="demo-6" tabindex="-1"><a class="header-anchor" href="#demo-6"><span>Demo</span></a></h3><p>Create a new workflow actions with below configurations(default values for all other fields):</p><ul><li>Name: IP whois lookup</li><li>Label: whois:$clientip$</li><li>Apply only to the following fields: clientip</li><li>URI: <a href="https://whois.domaintools.com/$clientip$" target="_blank" rel="noopener noreferrer">https://whois.domaintools.com/$clientip$</a></li></ul><p>Change the permissions of this workflow action to &quot;All apps(system)&quot; with admin write and everyone read.</p><p>Now go to searching &amp; reporting and type <code>index=web</code> in the search bar, expand a event and click menu &quot;Event Actions&quot; -&gt; &quot;whois:$clientip$&quot;.</p><figure><img src="`+o+`" alt="Workflow Actions" tabindex="0" loading="lazy"><figcaption>Workflow Actions</figcaption></figure><h2 id="data-normalization-troubleshooting" tabindex="-1"><a class="header-anchor" href="#data-normalization-troubleshooting"><span>Data Normalization &amp; Troubleshooting</span></a></h2><blockquote><p>Navigate to Settings -&gt; Fields -&gt; Field Aliases / Calculated Fields</p></blockquote><p>Field aliases: Normalize your data by creating a new field with a different name. Apply multiple fields to the same field alias. Make searching easier amongst users.</p><p>Calculated fields: Like a macro, but for fields. Save off quick math to output fields using the eval command, then use it in a search.</p><h3 id="buckets" tabindex="-1"><a class="header-anchor" href="#buckets"><span>Buckets</span></a></h3><p>Hot/warm/cold buckets are searchable. Warm and cold buckets cannot be written to.</p><ul><li>hot bucket: Data is being actively written to the bucket by an indexer. <strong>Only writable bucket</strong>.</li><li>warm bucket: Data is getting older, rolled from hot to warm.</li><li>cold bucket: Data is even older.</li><li>frozen bucket: Data is going to get archived or deleted after being frozen based on the data retention policy. Data is not searchable.</li><li>thawed bucket: Moved from frozen bucket, and the data is searchable again.</li></ul><h3 id="job-inspector" tabindex="-1"><a class="header-anchor" href="#job-inspector"><span>Job inspector</span></a></h3><ul><li>tool: allows you to troubleshoot your search efficiency, or reason for failing</li><li>informative: gives you information about how the search completed, and time it took to run</li><li>tips: if you are using a knowledge object wrong, it will suggest how to correct your search</li></ul><h3 id="demo-7" tabindex="-1"><a class="header-anchor" href="#demo-7"><span>Demo</span></a></h3><h4 id="field-aliases" tabindex="-1"><a class="header-anchor" href="#field-aliases"><span>Field Aliases</span></a></h4><ol><li>Figure out the source types for the indexes by using <code>index=web OR index=security OR index=cisco | stats values(sourcetype)</code>.</li><li>Create three field aliases with below configurations, so that all the indexes can be searched by the same field name <code>source_ip</code>: <ul><li>Name: <em>source_ip</em></li><li>Apply to <em>sourcetype</em> named <em>{sourcetype}</em> (sourcetype can be <em>linux_secure</em>, <em>access_combined</em> and <em>cisco:wsa:squid</em>)</li><li>Field aliases: <em>clientip=source_ip</em> (or <em>src=source_ip</em>, clientip and src are the fields that have values of ip addresses)</li></ul></li><li>Then run the search <code>index=web OR index=security OR index=cisco source_ip=*</code> to get all the events with ip addresses from the three indexes.</li></ol><h4 id="calculated-fields" tabindex="-1"><a class="header-anchor" href="#calculated-fields"><span>Calculated Fields</span></a></h4><ol><li>Create a new calculated field with below configurations: <ul><li>Apply to <em>sourcetype</em> named <em>access_combined</em></li><li>Name: <em>megs</em></li><li>Eval expression: <em>bytes/1024/1024</em></li></ul></li><li>Then run the search <code>index=web | stats sum(megs) as megs by file | sort - megs</code> to get the converted bytes to megs.</li></ol><h4 id="troubleshooting-your-spl" tabindex="-1"><a class="header-anchor" href="#troubleshooting-your-spl"><span>Troubleshooting your SPL</span></a></h4><ol><li>Job inspector</li><li>Administrator -&gt; Preferences -&gt; SPL Editor -&gt; Search assistant -&gt; Full</li></ol><h4 id="buckets-1" tabindex="-1"><a class="header-anchor" href="#buckets-1"><span>Buckets</span></a></h4><p>Returns information about the buckets in the Splunk Enterprise index.</p><div class="language-spl line-numbers-mode" data-highlighter="shiki" data-ext="spl" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">|</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> dbinspect</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> index</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=*</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">|</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> fields</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> bucketId,</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;"> state</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;"> index</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, modTime</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="data-models" tabindex="-1"><a class="header-anchor" href="#data-models"><span>Data Models</span></a></h2><h3 id="what-are-datamodels" tabindex="-1"><a class="header-anchor" href="#what-are-datamodels"><span>What are datamodels?</span></a></h3><ul><li>Hierarchical: parent and child relationship. Root dataset.</li><li>Dataset searching: select the specific datamodel and dataset you want to search.</li><li>Normalization tool: CIM(The Common Information Model) compliance, data mapping to a model that fits that type of data.</li><li>Large data searches: search larger amounts of data faster, with tstats and accelerated datamodels.</li></ul>`,51)),t("p",null,[i[4]||(i[4]=s("More information about datamodels can be found ")),n(e,{to:"/categories/splunk/Splunk-Visualizing.html#data-model"},{default:l(()=>i[3]||(i[3]=[s("here")])),_:1,__:[3]}),i[5]||(i[5]=s("."))]),i[8]||(i[8]=a(`<h3 id="commands-and-use-cases" tabindex="-1"><a class="header-anchor" href="#commands-and-use-cases"><span>Commands and use cases</span></a></h3><p>Get the count of events from the Web datamodel.</p><div class="language-spl line-numbers-mode" data-highlighter="shiki" data-ext="spl" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">|</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> tstats</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> count</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> from </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">datamodel</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=Web</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>Get the count of events from the Web datamodel by sourcetype.</p><div class="language-spl line-numbers-mode" data-highlighter="shiki" data-ext="spl" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">|</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> datamodel</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> Web search</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">|</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> search</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> sourcetype</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=*</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">|</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> stats</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> count</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> by</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> sourcetype</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Search the root dataset <em>Audit</em> of the <em>internal_audit_logs</em> datamodel.</p><div class="language-spl line-numbers-mode" data-highlighter="shiki" data-ext="spl" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">|</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> datamodel</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> internal_audit_logs Audit search</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">|</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> search</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> *</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="the-common-information-model" tabindex="-1"><a class="header-anchor" href="#the-common-information-model"><span>The Common Information Model</span></a></h2><h3 id="what-is-cim" tabindex="-1"><a class="header-anchor" href="#what-is-cim"><span>What is CIM</span></a></h3><p><a href="https://docs.splunk.com/Documentation/CIM/6.1.0/User/Overview" target="_blank" rel="noopener noreferrer">Common Information Model Add-on Manual</a></p><ul><li>A Model: a model to use and reference a common standard of operations for how all data is handled.</li><li>An Application: CIM Add-On and the CIM Add-On Builder are available for free.</li><li>Data Normalizer: in the end, all fields can have the same name. All apps can co-exist together.</li></ul><h3 id="how-to-leverage-its-features" tabindex="-1"><a class="header-anchor" href="#how-to-leverage-its-features"><span>How to leverage its features</span></a></h3><ul><li>Normarlize Data: the CIM gives Splunkers a way to normalize data.</li><li>Assistance: leverage it when creating field extractions, aliases, tags, etc.</li><li>Datamodel command: be able to run common searches that span larger amount of data.</li></ul><h3 id="why-it-is-important" tabindex="-1"><a class="header-anchor" href="#why-it-is-important"><span>Why it is important</span></a></h3><ul><li>Splunk Premium Apps: Splunk Enterprise Security relies heavily on CIM compliance data.</li><li>Health Check Tool: Perform faster, more efficient searches that leverage searching data models instead of raw events.</li><li>Ease of Use: Find commonality between Splunkers.</li><li>Audit: Check to see if all of our data going into Splunk is CIM compliant.</li></ul><p>Two CIM add-ons are available for free:</p><ul><li>The standard CIM Add-On</li><li>The tool of the CIM Add-On Builder</li></ul><h3 id="demo-cim-add-on" tabindex="-1"><a class="header-anchor" href="#demo-cim-add-on"><span>Demo - CIM Add-On</span></a></h3><ol><li>Navigate to <em>Apps -&gt; Find More Apps -&gt; Search &quot;CIM&quot;</em></li><li>Install add-on &quot;<strong>Splunk Common Information Model (CIM)</strong>&quot; and restart the Splunk server.</li><li>Go to <em>Settings -&gt; Data Models</em>, you can see there have been added some data models which come with the CIM add-on.</li><li>Create a new event type with following configurations: <ul><li>Name: <em>web1</em></li><li>Search string: <code>index=web host=web1</code></li><li>Tags: <em>web</em> (The Web data model needs the <strong>field</strong> <em>tag</em> to be <em>web</em>)</li><li>Color: <em>magenta</em></li><li>Priority: <em>1 (Highest)</em></li></ul></li><li>Edit the permissions of the event type to &quot;All apps(system)&quot; with admin write and everyone read.</li><li>Now go to the <em>Settings -&gt; Data models -&gt; Web -&gt; Pivot -&gt; Web</em>, there should have count of events larger than 0.</li><li>Or run the search <code>| tstats count from datamodel=Web</code> to get the count of events from the <em>Web</em> data model.</li></ol><h3 id="demo-cim-add-on-builder" tabindex="-1"><a class="header-anchor" href="#demo-cim-add-on-builder"><span>Demo - CIM Add-On Builder</span></a></h3><ol><li>Navigate to <em>Apps -&gt; Find More Apps -&gt; Search &quot;Splunk Add-on Builder&quot;</em></li><li>Install add-on &quot;<strong>Splunk Add-on Builder</strong>&quot; and restart the Splunk server.</li><li>Create a new add-on with a name &quot;<strong>My Custom CIM</strong>&quot; and leave the other fields as default.</li><li>Go to <em>Manage Source Types</em> tab and click on the <em>Add</em> button to select <em>Import From Splunk</em> from the dropdown menu.</li><li>Then <em>Select a Source Type</em>: <em>access_combined</em>* and save.</li><li>Move to the tab <em>Map to Data Models</em> and click on the button <em>New Data Model Mapping</em> with below configurations: <ul><li>Enter a name for the event type: <em>web2</em></li><li>Select one or more source types: <em>access_combined</em></li><li>Enter a search: <code>(index=web sourcetype=access_combined)</code></li></ul></li><li>Click on the <em>Save</em> button to save the mapping.</li><li>In the <em>Data Model Mapping Details</em> page, click on the button <em>Select Data Model(s)</em> on the right side of the page.</li><li>Select the <em>Web</em> data model and click on the <em>Select</em> button.</li><li>Click on the <em>New Knowledge Object</em> button and select <em>FIELDALIAS</em> from the dropdown menu.</li><li>Select a field <em>clientip</em> on the left side to map to the field <em>src</em> on the right side.</li><li>When finished mapping all fields, click on the <em>Done</em> button.</li><li>Move to the tab <em>Validate &amp; Package</em>, this is where you can validate and download the TA(technology add-on) package.</li><li>Now run the search <code>| tstats count from datamodel=Web</code> to get the count of events from the <em>Web</em> data model. The result proves that all the events are mapped to the <em>Web</em> data model.</li><li>Go to <em>Settings -&gt; All configrations</em>, this is where you can see the TA that you just built.</li></ol>`,21))])}const A=h(c,[["render",g]]),m=JSON.parse('{"path":"/categories/splunk/Splunk-Core-Certified-Power-User.html","title":"Splunk Core Certified Power User","lang":"en-US","frontmatter":{"title":"Splunk Core Certified Power User","date":"2025-06-01T09:00:00.000Z","categories":["splunk"],"tags":["splunk","splunk-core-certified-power-user","splunk-core-certified-power-user-exam","splunk-core-certified-power-user-certification"],"description":"Exam preparation notes for the Splunk Core Certified Power User. Transforming Commands If you are doing search in smart mode, the mode that will toggle the search behavior based...","head":[["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"Splunk Core Certified Power User\\",\\"image\\":[\\"\\"],\\"datePublished\\":\\"2025-06-01T09:00:00.000Z\\",\\"dateModified\\":\\"2025-06-16T14:24:59.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"DevOpsMe\\",\\"url\\":\\"https://github.com/JoneyXiao/devopsme\\"}]}"],["meta",{"property":"og:url","content":"https://vuepress-theme-hope-docs-demo.netlify.app/devopsme/categories/splunk/Splunk-Core-Certified-Power-User.html"}],["meta",{"property":"og:site_name","content":"DevOpsMe"}],["meta",{"property":"og:title","content":"Splunk Core Certified Power User"}],["meta",{"property":"og:description","content":"Exam preparation notes for the Splunk Core Certified Power User. Transforming Commands If you are doing search in smart mode, the mode that will toggle the search behavior based..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"en-US"}],["meta",{"property":"og:updated_time","content":"2025-06-16T14:24:59.000Z"}],["meta",{"property":"article:tag","content":"splunk-core-certified-power-user-certification"}],["meta",{"property":"article:tag","content":"splunk-core-certified-power-user-exam"}],["meta",{"property":"article:tag","content":"splunk-core-certified-power-user"}],["meta",{"property":"article:tag","content":"splunk"}],["meta",{"property":"article:published_time","content":"2025-06-01T09:00:00.000Z"}],["meta",{"property":"article:modified_time","content":"2025-06-16T14:24:59.000Z"}]]},"git":{"createdTime":1748444198000,"updatedTime":1750083899000,"contributors":[{"name":"Joney Xiao","username":"","email":"87732444@qq.com","commits":2}]},"readingTime":{"minutes":11.03,"words":3310},"filePathRelative":"categories/splunk/Splunk-Core-Certified-Power-User.md","autoDesc":true}');export{A as comp,m as data};
